{"title":"Arthas获取Spring Context","slug":"yuque/Arthas获取Spring Context","date":"2020-06-20T16:00:00.000Z","updated":"2022-05-15T04:19:28.497Z","comments":true,"path":"api/articles/arthas/arthas-context.json","excerpt":"> Arthas 是 Alibaba 开源的> Java 诊断工具，深受开发者喜爱。> https://github.com/alibaba/arthasArthas提供了非常丰富的关于调用拦截的命令，比如trace/watch/monitor/tt。但是很多时候我们在排查问题时，需要更多的线索，并不只是函数的参数和返回值。比如在一个 spring应用里，想获取到 springcontext 里的其它bean。如果能随意获取到 springbean，那就可以“为所欲为”了，下面介绍如何利用Arthas 获取到 springcontext。> 搜索类 sc -d","covers":["/images/c2.jpg"],"content":"<blockquote>\n<p>Arthas 是 Alibaba 开源的 Java 诊断工具，深受开发者喜爱。<br><a href=\"https://github.com/alibaba/arthas\">https://github.com/alibaba/arthas</a></p>\n</blockquote>\n<p>Arthas 提供了非常丰富的关于调用拦截的命令，比如 trace&#x2F;watch&#x2F;monitor&#x2F;tt 。但是很多时候我们在排查问题时，需要更多的线索，并不只是函数的参数和返回值。<br>比如在一个 spring 应用里，想获取到 spring context 里的其它 bean。如果能随意获取到 spring bean，那就可以“为所欲为”了，下面介绍如何利用 Arthas 获取到 spring context。</p>\n<blockquote>\n<p>搜索类 sc -d com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory<br>找不到对应类，可参考 <a href=\"http://www.zyiz.net/tech/detail-138429.html\">http://www.zyiz.net/tech/detail-138429.html</a></p>\n</blockquote>\n<p>获取数据库密码步骤</p>\n<h2 id=\"1、获取-classLoder-的-hash-值\"><a href=\"#1、获取-classLoder-的-hash-值\" class=\"headerlink\" title=\"1、获取 classLoder 的 hash 值\"></a>1、获取 classLoder 的 hash 值</h2><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">sc -d com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory\nclass-info com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory\ncode-source    &#x2F;data&#x2F;project&#x2F;aladdin&#x2F;second&#x2F;dubbo-3.2.18-RELEASE.jar\nname  com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory\nsuper-class    +-java.lang.Object\nclass-loader   +-com.youzan.aladdin.container.loader.AladdinClassLoader@ae13544\n       +-sun.misc.Launcher$AppClassLoader@18b4aac2\n       +-sun.misc.Launcher$ExtClassLoader@7bb52275\nclassLoaderHash  ae13544</code></pre>\n\n<h2 id=\"2、获取对应实例数据\"><a href=\"#2、获取对应实例数据\" class=\"headerlink\" title=\"2、获取对应实例数据\"></a>2、获取对应实例数据</h2><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ognl -c ae13544 &#39;#context&#x3D;@com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory@contexts.iterator.next, #context.getBean(&quot;dataSource&quot;).getPassword()&#39;</code></pre>\n\n<h2 id=\"3、可调用任务任意的方法\"><a href=\"#3、可调用任务任意的方法\" class=\"headerlink\" title=\"3、可调用任务任意的方法\"></a>3、可调用任务任意的方法</h2><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ognl -c ae13544 &#39;#context&#x3D;@com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory@contexts.iterator.next, #obj&#x3D;new com.youzan.ebiz.video.channels.item.api.param.wechat.ItemListGetReq(),#obj.kdtId&#x3D;42163374,#obj.itemIds&#x3D;&#123;1562453283&#125;,#context.getBean(&quot;wechatChannelConsoleServiceImpl&quot;).listAuditStatus(#obj)&#39;</code></pre>\n","more":"<blockquote>\n<p>Arthas 是 Alibaba 开源的 Java 诊断工具，深受开发者喜爱。<br><a href=\"https://github.com/alibaba/arthas\">https://github.com/alibaba/arthas</a></p>\n</blockquote>\n<p>Arthas 提供了非常丰富的关于调用拦截的命令，比如 trace&#x2F;watch&#x2F;monitor&#x2F;tt 。但是很多时候我们在排查问题时，需要更多的线索，并不只是函数的参数和返回值。<br>比如在一个 spring 应用里，想获取到 spring context 里的其它 bean。如果能随意获取到 spring bean，那就可以“为所欲为”了，下面介绍如何利用 Arthas 获取到 spring context。</p>\n<blockquote>\n<p>搜索类 sc -d com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory<br>找不到对应类，可参考 <a href=\"http://www.zyiz.net/tech/detail-138429.html\">http://www.zyiz.net/tech/detail-138429.html</a></p>\n</blockquote>\n<p>获取数据库密码步骤</p>\n<h2 id=\"1、获取-classLoder-的-hash-值\"><a href=\"#1、获取-classLoder-的-hash-值\" class=\"headerlink\" title=\"1、获取 classLoder 的 hash 值\"></a>1、获取 classLoder 的 hash 值</h2><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">sc -d com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory\nclass-info com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory\ncode-source    &#x2F;data&#x2F;project&#x2F;aladdin&#x2F;second&#x2F;dubbo-3.2.18-RELEASE.jar\nname  com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory\nsuper-class    +-java.lang.Object\nclass-loader   +-com.youzan.aladdin.container.loader.AladdinClassLoader@ae13544\n       +-sun.misc.Launcher$AppClassLoader@18b4aac2\n       +-sun.misc.Launcher$ExtClassLoader@7bb52275\nclassLoaderHash  ae13544</code></pre>\n\n<h2 id=\"2、获取对应实例数据\"><a href=\"#2、获取对应实例数据\" class=\"headerlink\" title=\"2、获取对应实例数据\"></a>2、获取对应实例数据</h2><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ognl -c ae13544 &#39;#context&#x3D;@com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory@contexts.iterator.next, #context.getBean(&quot;dataSource&quot;).getPassword()&#39;</code></pre>\n\n<h2 id=\"3、可调用任务任意的方法\"><a href=\"#3、可调用任务任意的方法\" class=\"headerlink\" title=\"3、可调用任务任意的方法\"></a>3、可调用任务任意的方法</h2><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ognl -c ae13544 &#39;#context&#x3D;@com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory@contexts.iterator.next, #obj&#x3D;new com.youzan.ebiz.video.channels.item.api.param.wechat.ItemListGetReq(),#obj.kdtId&#x3D;42163374,#obj.itemIds&#x3D;&#123;1562453283&#125;,#context.getBean(&quot;wechatChannelConsoleServiceImpl&quot;).listAuditStatus(#obj)&#39;</code></pre>\n","categories":[{"name":"arthas","path":"api/categories/arthas.json"}],"tags":[{"name":"Arthas","path":"api/tags/Arthas.json"}]}