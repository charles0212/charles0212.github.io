{"name":"short-url","postlist":[{"title":"短链生成","slug":"yuque/短链生成","date":"2019-06-20T16:00:00.000Z","updated":"2022-05-15T04:19:28.496Z","comments":true,"path":"api/articles/url/short-url.json","excerpt":"背景当前短地址发号使用 hbase 的increament 指令,每个转短请求都会做一次操作, 当 qps超过 1k 时, 会造成 hbase机器报警, 需要减少 hbase 的increament 指令调用方案修改为每个请求在本地取号,当本地无号可取时请求 hbase 发号,每次在 hbase 中调用increament 时取 100个号, 回到本地具体代码流程 * 加全局锁,   所有转短请求在取号前通过全局锁串行 * 尝试本地取号, 如果不成功, 去   hbase 取号 100 个,   放入本地缓存 * 解锁, 并继续原有转短流程","keywords":null,"cover":["/images/c1.jpg"],"content":null,"raw":null,"categories":[{"name":"short-url","path":"api/categories/short-url.json"}],"tags":[{"name":"ShortUrl","path":"api/tags/ShortUrl.json"}]}]}